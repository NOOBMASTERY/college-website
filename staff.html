<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ - ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏ì‡∏¥‡∏ä‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏≤‡∏á‡∏ô‡∏≤</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <style>
    /* ‚îÄ‚îÄ layout: sidebar flush left ‚îÄ‚îÄ */
    .staff-page-wrap { display: flex; align-items: flex-start; }

    .filter-sidebar {
      position: sticky; top: 72px;
      width: 240px; min-width: 240px;
      max-height: calc(100vh - 80px); overflow-y: auto;
      background: var(--surface); border-right: 1px solid var(--border);
      padding: 24px 16px 28px 20px; flex-shrink: 0;
    }
    .filter-sidebar h2 {
      font-family: "Noto Serif Thai",serif;
      font-size: 0.92rem; font-weight: 700; color: var(--primary);
      margin-bottom: 16px; padding-bottom: 10px;
      border-bottom: 2px solid var(--accent);
      display: flex; align-items: center; gap: 8px;
    }
    .filter-group { margin-bottom: 18px; }
    .filter-group-title {
      font-size: 0.7rem; font-weight: 700; color: var(--muted);
      text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 7px;
    }
    .filter-search {
      width: 100%; padding: 8px 10px;
      border: 1.5px solid var(--border); border-radius: var(--radius-sm);
      font-family: "Sarabun",sans-serif; font-size: 0.84rem;
      background: var(--surface-2); color: var(--text);
      outline: none; transition: border-color 0.2s; box-sizing: border-box;
    }
    .filter-search:focus { border-color: var(--primary-light); }
    .filter-checkbox-group { display: flex; flex-direction: column; gap: 2px; }
    .filter-label {
      display: flex; align-items: center; gap: 7px; cursor: pointer;
      font-size: 0.79rem; color: var(--text-2);
      padding: 4px 6px; border-radius: 6px; transition: background 0.15s;
    }
    .filter-label:hover { background: var(--surface-2); }
    .filter-label input[type="checkbox"] {
      accent-color: var(--primary); width: 13px; height: 13px; flex-shrink: 0;
    }
    .filter-count {
      margin-left: auto; font-size: 0.67rem;
      background: var(--surface-2); border: 1px solid var(--border);
      border-radius: 20px; padding: 1px 6px; color: var(--muted);
    }
    .filter-reset-btn {
      width: 100%; padding: 8px; border-radius: var(--radius-sm);
      font-size: 0.79rem; font-weight: 600; font-family: "Sarabun",sans-serif;
      background: var(--surface-2); border: 1.5px solid var(--border);
      color: var(--muted); cursor: pointer; transition: var(--transition); margin-top: 6px;
    }
    .filter-reset-btn:hover { border-color: var(--primary); color: var(--primary); background: rgba(37,99,235,0.06); }

    /* ‚îÄ‚îÄ content ‚îÄ‚îÄ */
    .staff-content { flex: 1; min-width: 0; padding: 24px 24px 48px; }

    /* ‚îÄ‚îÄ summary bar ‚îÄ‚îÄ */
    .staff-summary-bar {
      display: flex; align-items: center; flex-wrap: wrap; gap: 14px;
      background: var(--surface); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 12px 16px;
      margin-bottom: 16px; box-shadow: var(--shadow);
    }
    .sum-total { font-size: 0.84rem; color: var(--muted); }
    .sum-total strong { color: var(--primary); font-size: 1.05rem; font-weight: 700; }
    .sum-sep { width: 1px; height: 18px; background: var(--border); }
    .sum-tab { font-size: 0.82rem; color: var(--muted); display: flex; align-items: center; gap: 6px; }
    .tab-badge { background: var(--primary); color: #fff; border-radius: 20px; padding: 1px 9px; font-size: 0.77rem; font-weight: 700; }
    .sum-filtered { margin-left: auto; font-size: 0.79rem; color: var(--muted); }
    .sum-filtered strong { color: var(--primary); }

    /* ‚îÄ‚îÄ tabs ‚îÄ‚îÄ */
    .staff-tabs-wrapper { margin-bottom: 16px; overflow-x: auto; padding-bottom: 4px; }
    #staffTabs { display: flex; gap: 6px; min-width: max-content; }
    .tab-btn {
      padding: 6px 14px; border-radius: 50px; font-size: 0.8rem; font-weight: 600;
      font-family: "Sarabun",sans-serif; color: var(--muted);
      background: var(--surface); border: 1.5px solid var(--border);
      white-space: nowrap; transition: var(--transition); cursor: pointer;
      display: flex; align-items: center; gap: 5px;
    }
    .tab-btn:hover { border-color: var(--primary-light); color: var(--primary); }
    .tab-btn.active { background: var(--primary); border-color: var(--primary); color: #fff; box-shadow: 0 3px 10px rgba(30,58,138,0.25); }
    .tab-num { font-size: 0.68rem; background: rgba(255,255,255,0.2); border-radius: 10px; padding: 0 5px; }
    .tab-btn:not(.active) .tab-num { background: var(--surface-2); color: var(--muted); }

    /* ‚îÄ‚îÄ grid: auto-fill ‚â•140px ‚îÄ‚îÄ */
    #staffContainer {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 14px; min-height: 200px;
    }

    /* ‚îÄ‚îÄ card ‚îÄ‚îÄ */
    .staff-card {
      text-align: center; cursor: pointer;
      background: var(--surface); border-radius: var(--radius);
      padding: 14px 10px 12px;
      border: 1px solid var(--border); box-shadow: var(--shadow);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .staff-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-lg); }
    .staff-card:focus-visible { outline: 3px solid var(--primary-light); outline-offset: 3px; }

    /* ‡∏£‡∏π‡∏õ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î ‚Äî fixed 3:4 */
    .s-img-wrap {
      width: 80px; height: 107px;
      margin: 0 auto 10px; overflow: hidden;
      border-radius: 7px; border: 2px solid var(--border);
      background: var(--surface-2); flex-shrink: 0;
    }
    .s-img-wrap img {
      width: 80px; height: 107px;
      object-fit: cover; display: block;
      transition: transform 0.4s;
    }
    .staff-card:hover .s-img-wrap img { transform: scale(1.06); }

    /* placeholder */
    .s-img-wrap .ph {
      width: 80px; height: 107px;
      display: flex; align-items: center; justify-content: center;
      background: linear-gradient(135deg,#e2e8f0,#cbd5e1); color: #94a3b8;
    }
    body.dark .s-img-wrap .ph { background: linear-gradient(135deg,#1e2535,#253047); }

    .s-name { font-size: 0.76rem; font-weight: 700; color: var(--text); line-height: 1.4; margin-bottom: 3px; word-break: break-word; }
    .s-role { font-size: 0.68rem; color: var(--muted); line-height: 1.4; margin-bottom: 4px; }
    .s-badge {
      display: inline-block; font-size: 0.6rem; padding: 1px 6px;
      border-radius: 20px; background: rgba(37,99,235,0.07);
      color: var(--primary); border: 1px solid rgba(37,99,235,0.13);
      max-width: 100%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
    }
    .empty-msg {
      grid-column: 1/-1; text-align: center;
      color: var(--muted); padding: 60px 0; font-size: 0.95rem;
    }

    /* ‚îÄ‚îÄ modal ‚îÄ‚îÄ */
    .modal {
      position: fixed; inset: 0; background: rgba(0,0,0,0.75);
      display: flex; justify-content: center; align-items: center;
      padding: 16px; opacity: 0; pointer-events: none;
      transition: opacity 0.3s; z-index: 2000;
    }
    .modal.open { opacity: 1; pointer-events: auto; }
    .modal.open .modal-box { transform: translateY(0) scale(1); }
    .modal-box {
      background: var(--surface); color: var(--text);
      border-radius: 20px; max-width: 460px; width: 100%;
      padding: 34px 28px 26px; position: relative;
      text-align: center; box-shadow: var(--shadow-lg);
      transform: translateY(24px) scale(0.97);
      transition: transform 0.35s cubic-bezier(0.34,1.56,0.64,1);
      max-height: 90vh; overflow-y: auto;
    }
    .modal-close {
      position: absolute; top: 12px; right: 12px;
      width: 30px; height: 30px; border-radius: 50%;
      background: var(--surface-2); border: 1px solid var(--border);
      color: var(--muted); font-size: 1.1rem;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; transition: 0.2s;
    }
    .modal-close:hover { background: #fee2e2; color: #dc2626; }

    #modalImgWrap { margin: 0 auto 16px; width: 140px; height: 187px; }
    #modalImgWrap img {
      width: 140px; height: 187px;
      object-fit: cover; border-radius: 10px; display: block;
      box-shadow: 0 6px 20px rgba(0,0,0,.15); border: 3px solid var(--border);
    }
    #modalImgWrap .ph {
      width: 140px; height: 187px;
      border-radius: 10px; border: 3px solid var(--border);
      background: linear-gradient(135deg,#e2e8f0,#cbd5e1);
      display: flex; align-items: center; justify-content: center; color: #94a3b8;
    }
    body.dark #modalImgWrap .ph { background: linear-gradient(135deg,#1e2535,#253047); }

    .modal-name { font-family: "Noto Serif Thai",serif; font-size: 1.08rem; font-weight: 700; margin-bottom: 8px; word-break: break-word; }
    .modal-info { display: flex; flex-direction: column; gap: 7px; margin-top: 14px; text-align: left; }
    .modal-row {
      display: flex; gap: 10px; align-items: flex-start;
      padding: 8px 12px; background: var(--surface-2);
      border-radius: 8px; border: 1px solid var(--border);
    }
    .modal-row .icon { font-size: 0.9rem; flex-shrink: 0; margin-top: 2px; }
    .modal-row .lbl { font-size: 0.72rem; color: var(--muted); margin-bottom: 1px; }
    .modal-row .val { font-size: 0.87rem; font-weight: 600; color: var(--text); line-height: 1.4; }

    /* ‚îÄ‚îÄ responsive ‚îÄ‚îÄ */
    @media (max-width: 1100px) {
      .filter-sidebar { width: 200px; min-width: 200px; }
      #staffContainer { grid-template-columns: repeat(auto-fill, minmax(128px,1fr)); }
    }
    @media (max-width: 760px) {
      .staff-page-wrap { flex-direction: column; }
      .filter-sidebar {
        position: static; width: 100%; min-width: unset;
        max-height: none; border-right: none; border-bottom: 1px solid var(--border);
      }
      .filter-checkbox-group { flex-direction: row; flex-wrap: wrap; }
      .staff-content { padding: 16px 12px 40px; }
      #staffContainer { grid-template-columns: repeat(auto-fill, minmax(110px,1fr)); gap: 10px; }
    }
    @media (max-width: 480px) {
      #staffContainer { grid-template-columns: repeat(2,1fr); gap: 9px; }
      .s-img-wrap { width: 72px; height: 96px; }
      .s-img-wrap img, .s-img-wrap .ph { width: 72px; height: 96px; }
      .s-name { font-size: 0.73rem; }
      .sum-sep { display: none; }
    }
    @media (max-width: 360px) {
      #staffContainer { grid-template-columns: repeat(2,1fr); gap: 8px; }
      .staff-card { padding: 10px 6px 9px; }
    }
  </style>
</head>
<body>

<header class="site-header">
  <div class="container header-inner">
    <a href="index.html" class="logo-area">
      <img src="assets/images/logo.jpg" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ">
      <div class="brand"><h1>‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏ì‡∏¥‡∏ä‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏≤‡∏á‡∏ô‡∏≤</h1><span>Bangna Commercial College</span></div>
    </a>
    <nav class="nav" aria-label="‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å">
      <ul class="nav-links">
        <li><a href="index.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
        <li><a href="management.html">‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</a></li>
        <li><a href="staff.html" class="active">‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£</a></li>
        <li><a href="students.html">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</a></li>
        <li><a href="programs.html">‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤</a></li>
      </ul>
      <button id="darkToggle" class="toggle-btn" aria-label="‡∏™‡∏•‡∏±‡∏ö‡∏ò‡∏µ‡∏°">üåô</button>
      <div class="hamburger" role="button" aria-label="‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π" tabindex="0">‚ò∞</div>
    </nav>
  </div>
</header>

<div class="page-banner">
  <div class="container">
    <h1>‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£</h1>
    <p>‡∏Ñ‡∏ì‡∏≤‡∏à‡∏≤‡∏£‡∏¢‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏ó‡∏∏‡πà‡∏°‡πÄ‡∏ó‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</p>
  </div>
</div>

<div class="staff-page-wrap">

  <!-- sidebar -->
  <aside class="filter-sidebar" aria-label="‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£">
    <h2>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ / ‡∏Å‡∏£‡∏≠‡∏á</h2>

    <div class="filter-group">
      <div class="filter-group-title">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠</div>
      <input type="search" id="searchInput" class="filter-search" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠...">
    </div>

    <div class="filter-group">
      <div class="filter-group-title">‡πÄ‡∏û‡∏®</div>
      <div class="filter-checkbox-group" id="genderFilters">
        <label class="filter-label"><input type="checkbox" value="‡∏ä‡∏≤‡∏¢"   data-filter="gender" checked> ‡∏ä‡∏≤‡∏¢   <span class="filter-count" id="gc-‡∏ä‡∏≤‡∏¢">0</span></label>
        <label class="filter-label"><input type="checkbox" value="‡∏´‡∏ç‡∏¥‡∏á"  data-filter="gender" checked> ‡∏´‡∏ç‡∏¥‡∏á  <span class="filter-count" id="gc-‡∏´‡∏ç‡∏¥‡∏á">0</span></label>
        <label class="filter-label"><input type="checkbox" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ" data-filter="gender" checked> ‡∏≠‡∏∑‡πà‡∏ô‡πÜ <span class="filter-count" id="gc-‡∏≠‡∏∑‡πà‡∏ô‡πÜ">0</span></label>
      </div>
    </div>

    <div class="filter-group">
      <div class="filter-group-title">‡πÅ‡∏ú‡∏ô‡∏Å / ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</div>
      <div class="filter-checkbox-group" id="deptFilters"></div>
    </div>

    <div class="filter-group">
      <div class="filter-group-title">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
      <div class="filter-checkbox-group" id="eduFilters"></div>
    </div>

    <button class="filter-reset-btn" id="resetFilters">‚Ü∫ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
  </aside>

  <!-- content -->
  <div class="staff-content">
    <div class="staff-summary-bar">
      <div class="sum-total">‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <strong id="totalAll">0</strong> ‡∏Ñ‡∏ô</div>
      <div class="sum-sep"></div>
      <div class="sum-tab"><span id="tabLabel">‚Äî</span>: <span class="tab-badge" id="tabCount">0</span> ‡∏Ñ‡∏ô</div>
      <div class="sum-filtered" id="filteredInfo"></div>
    </div>

    <div class="staff-tabs-wrapper">
      <div id="staffTabs" role="tablist"></div>
    </div>

    <div id="staffContainer" role="tabpanel"></div>
  </div>
</div>

<!-- modal -->
<div id="profileModal" class="modal" role="dialog" aria-modal="true">
  <div class="modal-box">
    <button class="modal-close" aria-label="‡∏õ‡∏¥‡∏î">&times;</button>
    <div id="modalImgWrap"></div>
    <div class="modal-name" id="mName"></div>
    <div class="modal-info">
      <div class="modal-row"><span class="icon">üèÖ</span><div><div class="lbl">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</div><div class="val" id="mRole"></div></div></div>
      <div class="modal-row"><span class="icon">üè¢</span><div><div class="lbl">‡πÅ‡∏ú‡∏ô‡∏Å / ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</div><div class="val" id="mDept"></div></div></div>
      <div class="modal-row"><span class="icon">üéì</span><div><div class="lbl">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div><div class="val" id="mEdu"></div></div></div>
    </div>
  </div>
</div>

<footer class="site-footer">
  <div class="container">¬© 2026 ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏û‡∏ì‡∏¥‡∏ä‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏≤‡∏á‡∏ô‡∏≤ ¬∑ Bangna Commercial College</div>
</footer>

<script src="assets/js/staffData.js"></script>
<script>
(function(){
  'use strict';

  /* ‚îÄ‚îÄ placeholder SVG ‚îÄ‚îÄ */
  function makePh(sz) {
    var d = document.createElement('div');
    d.className = 'ph';
    d.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.3" width="' + sz + '" height="' + sz + '"><circle cx="12" cy="8" r="4.2"/><path d="M3.5 20.5c0-4.1 3.8-7.5 8.5-7.5s8.5 3.4 8.5 7.5"/></svg>';
    return d;
  }

  /* ‚îÄ‚îÄ gender detection ‚îÄ‚îÄ */
  function getGender(name) {
    if(!name) return '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
    if(/^(‡∏ô‡∏≤‡∏¢|Mr\.|MR\.|‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ)/.test(name.trim())) return '‡∏ä‡∏≤‡∏¢';
    if(/^(‡∏ô‡∏≤‡∏á|‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß|Miss|MISS)/.test(name.trim())) return '‡∏´‡∏ç‡∏¥‡∏á';
    return '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
  }

  /* ‚îÄ‚îÄ flat list (ALL members, including image:null) ‚îÄ‚îÄ */
  var ALL = [];
  Object.keys(staffCategoryData).forEach(function(key){
    if(key === 'all') return; /* skip the combined tab, it references same objects */
    var cat = staffCategoryData[key];
    (cat.members || []).forEach(function(p){
      ALL.push(Object.assign({}, p, { catKey: key, catLabel: cat.label, gender: getGender(p.name) }));
    });
  });
  var TOTAL = ALL.length;

  /* ‚îÄ‚îÄ dark mode ‚îÄ‚îÄ */
  (function(){
    var btn = document.getElementById('darkToggle');
    var apply = function(v){ document.body.classList.toggle('dark',v); localStorage.setItem('dark',v); if(btn) btn.textContent = v?'‚òÄÔ∏è':'üåô'; };
    apply(localStorage.getItem('dark') === 'true');
    if(btn) btn.addEventListener('click', function(){ apply(!document.body.classList.contains('dark')); });
  })();

  /* ‚îÄ‚îÄ mobile nav ‚îÄ‚îÄ */
  (function(){
    var b = document.querySelector('.hamburger');
    var n = document.querySelector('.nav-links');
    if(!b||!n) return;
    b.addEventListener('click', function(){ n.classList.toggle('show'); });
    document.querySelectorAll('.nav-links a').forEach(function(a){ a.addEventListener('click', function(){ n.classList.remove('show'); }); });
  })();

  /* ‚îÄ‚îÄ modal ‚îÄ‚îÄ */
  var modal = document.getElementById('profileModal');
  function closeModal() { modal.classList.remove('open'); document.body.style.overflow = ''; }
  modal.addEventListener('click', function(e){
    if(e.target === modal || e.target.classList.contains('modal-close')) closeModal();
  });
  document.addEventListener('keydown', function(e){ if(e.key==='Escape') closeModal(); });

  function openModal(p) {
    var wrap = document.getElementById('modalImgWrap');
    wrap.innerHTML = '';
    if(p.image) {
      var img = document.createElement('img');
      img.alt = p.name;
      img.addEventListener('error', function(){ wrap.innerHTML = ''; wrap.appendChild(makePh(54)); });
      img.src = p.image;
      wrap.appendChild(img);
    } else {
      wrap.appendChild(makePh(54));
    }
    document.getElementById('mName').textContent = p.name       || '‚Äî';
    document.getElementById('mRole').textContent = p.role       || '‚Äî';
    document.getElementById('mDept').textContent = p.department || '‚Äî';
    document.getElementById('mEdu').textContent  = p.education  || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
    modal.classList.add('open');
    document.body.style.overflow = 'hidden';
  }

  /* ‚îÄ‚îÄ state ‚îÄ‚îÄ */
  var activeTab = Object.keys(staffCategoryData)[0]; /* 'all' */
  var F = { search: '', gender: new Set(['‡∏ä‡∏≤‡∏¢','‡∏´‡∏ç‡∏¥‡∏á','‡∏≠‡∏∑‡πà‡∏ô‡πÜ']), dept: new Set(), edu: new Set() };

  /* ‚îÄ‚îÄ summary ‚îÄ‚îÄ */
  function updateSummary(shown, tabTotal) {
    document.getElementById('totalAll').textContent = TOTAL;
    document.getElementById('tabCount').textContent = tabTotal;
    document.getElementById('tabLabel').textContent = staffCategoryData[activeTab] ? staffCategoryData[activeTab].label : '';
    var fi = document.getElementById('filteredInfo');
    fi.innerHTML = shown < tabTotal ? '(‡∏Å‡∏£‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß: <strong>' + shown + '</strong> ‡∏Ñ‡∏ô)' : '';
  }

  /* ‚îÄ‚îÄ build filter checkboxes ‚îÄ‚îÄ */
  function buildFilters() {
    var members = getTabMembers(activeTab);

    /* gender counts */
    var gc = {};
    members.forEach(function(m){ gc[m.gender] = (gc[m.gender]||0)+1; });
    ['‡∏ä‡∏≤‡∏¢','‡∏´‡∏ç‡∏¥‡∏á','‡∏≠‡∏∑‡πà‡∏ô‡πÜ'].forEach(function(g){
      var el = document.getElementById('gc-'+g);
      if(el) el.textContent = gc[g]||0;
    });

    /* dept */
    var depts = [];
    members.forEach(function(m){ if(m.department && depts.indexOf(m.department)<0) depts.push(m.department); });
    depts.sort();
    var db = document.getElementById('deptFilters');
    db.innerHTML = '';
    if(F.dept.size === 0) depts.forEach(function(d){ F.dept.add(d); });
    depts.forEach(function(dept){
      var cnt = members.filter(function(m){ return m.department === dept; }).length;
      var lbl = document.createElement('label');
      lbl.className = 'filter-label';
      var cb = document.createElement('input');
      cb.type = 'checkbox'; cb.value = dept; cb.dataset.filter = 'dept';
      cb.checked = F.dept.has(dept);
      cb.addEventListener('change', onFilter);
      var txt = document.createTextNode(dept.replace(/^‡πÅ‡∏ú‡∏ô‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤/,'') + ' ');
      var cnt_el = document.createElement('span');
      cnt_el.className = 'filter-count'; cnt_el.textContent = cnt;
      lbl.appendChild(cb); lbl.appendChild(txt); lbl.appendChild(cnt_el);
      db.appendChild(lbl);
    });

    /* edu */
    var edus = [];
    members.forEach(function(m){ var e = m.education||'‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'; if(edus.indexOf(e)<0) edus.push(e); });
    edus.sort();
    var eb = document.getElementById('eduFilters');
    eb.innerHTML = '';
    if(F.edu.size === 0) edus.forEach(function(e){ F.edu.add(e); });
    edus.forEach(function(edu){
      var cnt = members.filter(function(m){ return (m.education||'‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏') === edu; }).length;
      var lbl = document.createElement('label');
      lbl.className = 'filter-label';
      var cb = document.createElement('input');
      cb.type = 'checkbox'; cb.value = edu; cb.dataset.filter = 'edu';
      cb.checked = F.edu.has(edu);
      cb.addEventListener('change', onFilter);
      var txt = document.createTextNode(edu + ' ');
      var cnt_el = document.createElement('span');
      cnt_el.className = 'filter-count'; cnt_el.textContent = cnt;
      lbl.appendChild(cb); lbl.appendChild(txt); lbl.appendChild(cnt_el);
      eb.appendChild(lbl);
    });
  }

  /* ‚îÄ‚îÄ get members for current tab ‚îÄ‚îÄ */
  function getTabMembers(key) {
    if (key === 'all') {
      /* For 'all' tab, use the combined list from staffCategoryData.all.members
         but augment with catKey/catLabel/gender */
      return staffCategoryData.all.members.map(function(m) {
        return Object.assign({}, m, { gender: getGender(m.name) });
      });
    }
    return ALL.filter(function(m){ return m.catKey === key; });
  }

  /* ‚îÄ‚îÄ create card ‚Äî ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á image:null ‚îÄ‚îÄ */
  function makeCard(p) {
    var card = document.createElement('div');
    card.className = 'staff-card';
    card.setAttribute('role','button');
    card.setAttribute('tabindex','0');

    var wrap = document.createElement('div');
    wrap.className = 's-img-wrap';
    if(p.image) {
      var img = document.createElement('img');
      img.alt = p.name; img.loading = 'lazy';
      img.addEventListener('error', function(){
        wrap.innerHTML = ''; wrap.appendChild(makePh(34));
      });
      img.src = p.image;
      wrap.appendChild(img);
    } else {
      wrap.appendChild(makePh(34));
    }

    var nm = document.createElement('div'); nm.className = 's-name'; nm.textContent = p.name;
    var rl = document.createElement('div'); rl.className = 's-role'; rl.textContent = p.role||'';
    var bd = document.createElement('span'); bd.className = 's-badge'; bd.textContent = (p.department||'').replace(/^‡πÅ‡∏ú‡∏ô‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤/,'');

    card.appendChild(wrap); card.appendChild(nm); card.appendChild(rl); card.appendChild(bd);
    card.addEventListener('click', function(){ openModal(p); });
    card.addEventListener('keydown', function(e){ if(e.key==='Enter'||e.key===' ') openModal(p); });
    return card;
  }

  /* ‚îÄ‚îÄ render grid ‚îÄ‚îÄ */
  function render() {
    var box = document.getElementById('staffContainer');
    box.innerHTML = '';
    var members = getTabMembers(activeTab);
    var tabTotal = members.length;

    /* detect actual active restrictions */
    var tabDepts = []; members.forEach(function(m){ if(m.department && tabDepts.indexOf(m.department)<0) tabDepts.push(m.department); });
    var tabEdus  = []; members.forEach(function(m){ var e=m.education||'‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'; if(tabEdus.indexOf(e)<0) tabEdus.push(e); });
    var deptRestrict = tabDepts.some(function(d){ return !F.dept.has(d); });
    var eduRestrict  = tabEdus.some(function(e){ return !F.edu.has(e); });

    var shown = members.filter(function(m){
      var nameOk = m.name.toLowerCase().indexOf(F.search.toLowerCase()) >= 0;
      var gOk    = F.gender.has(m.gender);
      var dOk    = !deptRestrict || F.dept.has(m.department);
      var eOk    = !eduRestrict  || F.edu.has(m.education||'‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏');
      return nameOk && gOk && dOk && eOk;
    });

    updateSummary(shown.length, tabTotal);

    if(!shown.length) {
      var empty = document.createElement('p');
      empty.className = 'empty-msg';
      empty.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç';
      box.appendChild(empty);
      return;
    }
    shown.forEach(function(p){ box.appendChild(makeCard(p)); });
  }

  /* ‚îÄ‚îÄ filter handler ‚îÄ‚îÄ */
  function onFilter(e) {
    var flt = e.target.dataset.filter;
    var val = e.target.value;
    var chk = e.target.checked;
    if(flt==='gender') { chk ? F.gender.add(val) : F.gender.delete(val); }
    else if(flt==='dept') { chk ? F.dept.add(val) : F.dept.delete(val); }
    else if(flt==='edu')  { chk ? F.edu.add(val)  : F.edu.delete(val); }
    render();
  }

  /* ‚îÄ‚îÄ reset ‚îÄ‚îÄ */
  function reset() {
    F = { search:'', gender: new Set(['‡∏ä‡∏≤‡∏¢','‡∏´‡∏ç‡∏¥‡∏á','‡∏≠‡∏∑‡πà‡∏ô‡πÜ']), dept: new Set(), edu: new Set() };
    var si = document.getElementById('searchInput'); if(si) si.value = '';
    document.querySelectorAll('[data-filter="gender"]').forEach(function(cb){ cb.checked = true; });
    buildFilters(); render();
  }

  /* ‚îÄ‚îÄ build tabs ‚îÄ‚îÄ */
  function buildTabs() {
    var box = document.getElementById('staffTabs');
    box.innerHTML = '';
    Object.keys(staffCategoryData).forEach(function(key){
      var cat = staffCategoryData[key];
      var cnt = key === 'all' ? staffCategoryData.all.members.length
                              : ALL.filter(function(m){ return m.catKey === key; }).length;
      var btn = document.createElement('button');
      btn.className = 'tab-btn' + (key===activeTab ? ' active' : '');
      btn.setAttribute('role','tab');
      btn.textContent = cat.label;
      var num = document.createElement('span');
      num.className = 'tab-num'; num.textContent = cnt;
      btn.appendChild(num);
      btn.addEventListener('click', function(){
        if(activeTab===key) return;
        activeTab = key;
        F.dept = new Set(); F.edu = new Set();
        document.querySelectorAll('.tab-btn').forEach(function(b){ b.classList.remove('active'); });
        btn.classList.add('active');
        buildFilters(); render();
      });
      box.appendChild(btn);
    });
  }

  /* ‚îÄ‚îÄ init ‚îÄ‚îÄ */
  document.addEventListener('DOMContentLoaded', function(){
    document.body.classList.add('loaded');
    document.getElementById('totalAll').textContent = TOTAL;
    buildTabs(); buildFilters(); render();

    var si = document.getElementById('searchInput');
    if(si) si.addEventListener('input', function(e){ F.search = e.target.value; render(); });

    document.querySelectorAll('[data-filter="gender"]').forEach(function(cb){ cb.addEventListener('change', onFilter); });

    var rb = document.getElementById('resetFilters');
    if(rb) rb.addEventListener('click', reset);
  });
})();
</script>
</body>
</html>